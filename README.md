# GDProxy

A small caching proxy for Geometry Dash.

## Why?

RobTop is known to block many cloud providers from accessing the GD servers, which can be frustrating if you don't have the connections to get whitelisted. At Globed, we have one of our servers whitelisted but not the rest, thus we can only make requests from that one. Instead of using confusing and ancient programs like Squid to proxy traffic, I decided to make this server, which simply proxies all requests to boomlings.com and also caches them for up to 1 hour.

## How to use

Install Rust and build/run using cargo:
```sh
cargo build --release # outputs the binary in ./target/release
cargo run --release   # runs the binary
```

A `config.toml` file will be generated upon first launch. There you can configure various things, described in the [Configuration](#configuration) section

To use the proxy, a token is required. One can be generated by running the binary with the `generate-token` argument:
```sh
./gd-proxy generate-token
```

To validate a token manually and get its ID:
```sh
./gd-proxy check-token <token>
```

Once you have a token and the server running, requests can be made in the same way as to the GD server, lifting empty user agent requirement and instead requiring an `Authorization` header:

```sh
curl -v http://localhost:3000/database/getGJUserInfo20.php \
    -d "secret=Wmfd2893gb7&targetAccountID=29843187" \
    -H "Authorization: your.token"
```

## Configuration

* `secret_key` - must be a hex-encoded 256-bit key, used for signing tokens. One can be generated via running `openssl rand -hex 32`, or just by running the server for the first time.
* `port` - port used to serve the HTTP server, by default 3000.
* `revoked_tokens` - a list of revoked token IDs. If a request uses a revoked token, it will be rejected with a 401 Unauthorized.
* `cache_ttl` - how long to cache responses for, in seconds, by default 3600 (1 hour). Use 0 to disable caching altogether.
